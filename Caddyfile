:80 {
    log {
        output stdout
    }

    # Proxy API requests to Backend
    handle /api/* {
        reverse_proxy backend:3000
    }

    # Proxy Socket.io to Backend
    handle /socket.io* {
        reverse_proxy backend:3000
    }

    # Proxy Uploads to Backend
    handle /uploads/* {
        reverse_proxy backend:3000
    }

    # Proxy everything else to Frontend Container
    handle /* {
        reverse_proxy frontend:80
    }
    
    # Enable Gzip compression
    encode gzip
}
